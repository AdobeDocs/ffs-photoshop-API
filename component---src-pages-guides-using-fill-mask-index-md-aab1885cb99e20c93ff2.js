"use strict";(self.webpackChunkdev_site_documentation_template=self.webpackChunkdev_site_documentation_template||[]).push([[529],{37251:function(e,a,t){t.r(a),t.d(a,{_frontmatter:function(){return p},default:function(){return h}});var s=t(58168),n=t(80045),i=(t(88763),t(15680)),o=t(83407);const r=["components"],p={},c=e=>function(a){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),(0,i.mdx)("div",a)},l=c("InlineAlert"),d=c("Accordion"),m=c("AccordionItem"),f={_frontmatter:p},u=o.A;function h(e){let{components:a}=e,t=(0,n.A)(e,r);return(0,i.mdx)(u,(0,s.A)({},f,t,{components:a,mdxType:"MDXLayout"}),(0,i.mdx)("h1",{id:"inpainting-with-fill-mask"},"Inpainting with Fill Mask"),(0,i.mdx)("p",null,"Learn how to use the Fill Masked Areas API in your code workflows by performing the image inpainting task in this guide."),(0,i.mdx)("h2",{id:"overview"},"Overview"),(0,i.mdx)("p",null,"This guide uses the Fill Masked Areas API to perform an image inpainting task."),(0,i.mdx)("p",null,"Image inpainting is one of the fundamental tasks in computer vision and has many practical applications, such as object removal and manipulation, image re-targeting, image compositing, and 3D effects."),(0,i.mdx)("p",null,"The API accepts an input image and an input mask indicating the hole(s) on the image and returns an image with the hole(s) filled."),(0,i.mdx)("h2",{id:"about-the-fill-masked-areas-api"},"About the Fill Masked Areas API"),(0,i.mdx)("p",null,"Before getting into the code, let's consider conceptually how the Fill Masked Areas API works at a high level."),(0,i.mdx)("ul",null,(0,i.mdx)("li",{parentName:"ul"},"You begin with a source image, which can be used with one of the supported cloud storage providers."),(0,i.mdx)("li",{parentName:"ul"},"You then provide a ",(0,i.mdx)("em",{parentName:"li"},"masked")," version of the image. That mask will be where the Photoshop API will add generated content.")),(0,i.mdx)("p",null,"Now, let's start the exercise."),(0,i.mdx)("h2",{id:"prerequisites"},"Prerequisites"),(0,i.mdx)("ul",null,(0,i.mdx)("li",{parentName:"ul"},"Valid credentials. If you don't have them yet, first visit the Firefly Services ",(0,i.mdx)("a",{parentName:"li",href:"../index.md"},"Getting Started")," guide to obtain a ",(0,i.mdx)("inlineCode",{parentName:"li"},"client_id")," and ",(0,i.mdx)("inlineCode",{parentName:"li"},"client_secret"),"."),(0,i.mdx)("li",{parentName:"ul"},"Node.js installed on your machine and basic familiarity with ",(0,i.mdx)("inlineCode",{parentName:"li"},"JavaScript"),"."),(0,i.mdx)("li",{parentName:"ul"},"Store the source and mask images below in a supported cloud storage provider.")),(0,i.mdx)("h3",{id:"source-image"},"Source image"),(0,i.mdx)("p",null,(0,i.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1280px"}},"\n      ",(0,i.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"100%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,i.mdx)("picture",{parentName:"span"},"\n          ",(0,i.mdx)("source",{parentName:"picture",srcSet:["/ffs-photoshop-API/static/c003971280888f9afcc622c8c3548ac4/5530d/source-image-fillMask.webp 320w","/ffs-photoshop-API/static/c003971280888f9afcc622c8c3548ac4/0c8fb/source-image-fillMask.webp 640w","/ffs-photoshop-API/static/c003971280888f9afcc622c8c3548ac4/94b1e/source-image-fillMask.webp 1280w","/ffs-photoshop-API/static/c003971280888f9afcc622c8c3548ac4/0b34d/source-image-fillMask.webp 1920w","/ffs-photoshop-API/static/c003971280888f9afcc622c8c3548ac4/96d48/source-image-fillMask.webp 2048w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/webp"}),"\n          ",(0,i.mdx)("source",{parentName:"picture",srcSet:["/ffs-photoshop-API/static/c003971280888f9afcc622c8c3548ac4/8980b/source-image-fillMask.jpg 320w","/ffs-photoshop-API/static/c003971280888f9afcc622c8c3548ac4/56d4e/source-image-fillMask.jpg 640w","/ffs-photoshop-API/static/c003971280888f9afcc622c8c3548ac4/62aaf/source-image-fillMask.jpg 1280w","/ffs-photoshop-API/static/c003971280888f9afcc622c8c3548ac4/aaf92/source-image-fillMask.jpg 1920w","/ffs-photoshop-API/static/c003971280888f9afcc622c8c3548ac4/09658/source-image-fillMask.jpg 2048w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/jpeg"}),"\n          ",(0,i.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/ffs-photoshop-API/static/c003971280888f9afcc622c8c3548ac4/62aaf/source-image-fillMask.jpg",alt:"Source image",title:"Source image",loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    ")),(0,i.mdx)("h3",{id:"mask-image"},"Mask image"),(0,i.mdx)("p",null,(0,i.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1280px"}},"\n      ",(0,i.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"100%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,i.mdx)("picture",{parentName:"span"},"\n          ",(0,i.mdx)("source",{parentName:"picture",srcSet:["/ffs-photoshop-API/static/965cac24c1b0dcd7d3fb911037e7ed2d/5530d/mask-image-fillMask.webp 320w","/ffs-photoshop-API/static/965cac24c1b0dcd7d3fb911037e7ed2d/0c8fb/mask-image-fillMask.webp 640w","/ffs-photoshop-API/static/965cac24c1b0dcd7d3fb911037e7ed2d/94b1e/mask-image-fillMask.webp 1280w","/ffs-photoshop-API/static/965cac24c1b0dcd7d3fb911037e7ed2d/0b34d/mask-image-fillMask.webp 1920w","/ffs-photoshop-API/static/965cac24c1b0dcd7d3fb911037e7ed2d/96d48/mask-image-fillMask.webp 2048w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/webp"}),"\n          ",(0,i.mdx)("source",{parentName:"picture",srcSet:["/ffs-photoshop-API/static/965cac24c1b0dcd7d3fb911037e7ed2d/8980b/mask-image-fillMask.jpg 320w","/ffs-photoshop-API/static/965cac24c1b0dcd7d3fb911037e7ed2d/56d4e/mask-image-fillMask.jpg 640w","/ffs-photoshop-API/static/965cac24c1b0dcd7d3fb911037e7ed2d/62aaf/mask-image-fillMask.jpg 1280w","/ffs-photoshop-API/static/965cac24c1b0dcd7d3fb911037e7ed2d/aaf92/mask-image-fillMask.jpg 1920w","/ffs-photoshop-API/static/965cac24c1b0dcd7d3fb911037e7ed2d/09658/mask-image-fillMask.jpg 2048w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/jpeg"}),"\n          ",(0,i.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/ffs-photoshop-API/static/965cac24c1b0dcd7d3fb911037e7ed2d/62aaf/mask-image-fillMask.jpg",alt:"Mask image",title:"Mask image",loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    ")),(0,i.mdx)("h2",{id:"calling-the-fill-masked-areas-api"},"Calling the Fill Masked Areas API"),(0,i.mdx)("p",null,"Use the ",(0,i.mdx)("a",{parentName:"p",href:"../../api/"},"v1/mask-objects")," endpoint first to generate masks to provide in your requests to this endpoint."),(0,i.mdx)("p",null,"A simple example of the request body required to use the API is below:"),(0,i.mdx)("pre",null,(0,i.mdx)("code",{parentName:"pre",className:"language-json"},'{\n  "image": {\n    "source": {\n      "url": "<source_image_url>"\n    }\n  },\n  "masks": [\n    {\n      "source": {\n        "url": "<mask_image_url>"\n      }\n    }\n  ]\n}\n')),(0,i.mdx)("p",null,"The source of the images, take pre-signed URLs from the cloud storage provider."),(0,i.mdx)(l,{variant:"info",slots:"header, text",mdxType:"InlineAlert"}),(0,i.mdx)("p",null,"NOTE"),(0,i.mdx)("p",null,"The Photoshop API has a ",(0,i.mdx)("inlineCode",{parentName:"p"},"mask-objects")," endpoint that can be used to create masks for an operation like inpainting."),(0,i.mdx)("h2",{id:"generated-result"},"Generated result"),(0,i.mdx)("p",null,"You can see in the image below that by masking the dog, and then filling that masked area, the API has generated a new image with the dog removed."),(0,i.mdx)("p",null,(0,i.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1280px"}},"\n      ",(0,i.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"100%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,i.mdx)("picture",{parentName:"span"},"\n          ",(0,i.mdx)("source",{parentName:"picture",srcSet:["/ffs-photoshop-API/static/44fc41924f66a0b90f4acb719da4d173/5530d/result-fillMask.webp 320w","/ffs-photoshop-API/static/44fc41924f66a0b90f4acb719da4d173/0c8fb/result-fillMask.webp 640w","/ffs-photoshop-API/static/44fc41924f66a0b90f4acb719da4d173/94b1e/result-fillMask.webp 1280w","/ffs-photoshop-API/static/44fc41924f66a0b90f4acb719da4d173/0b34d/result-fillMask.webp 1920w","/ffs-photoshop-API/static/44fc41924f66a0b90f4acb719da4d173/96d48/result-fillMask.webp 2048w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/webp"}),"\n          ",(0,i.mdx)("source",{parentName:"picture",srcSet:["/ffs-photoshop-API/static/44fc41924f66a0b90f4acb719da4d173/dd4a7/result-fillMask.png 320w","/ffs-photoshop-API/static/44fc41924f66a0b90f4acb719da4d173/0f09e/result-fillMask.png 640w","/ffs-photoshop-API/static/44fc41924f66a0b90f4acb719da4d173/bbbf7/result-fillMask.png 1280w","/ffs-photoshop-API/static/44fc41924f66a0b90f4acb719da4d173/ac7a9/result-fillMask.png 1920w","/ffs-photoshop-API/static/44fc41924f66a0b90f4acb719da4d173/2eb59/result-fillMask.png 2048w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/png"}),"\n          ",(0,i.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/ffs-photoshop-API/static/44fc41924f66a0b90f4acb719da4d173/bbbf7/result-fillMask.png",alt:"Generated Result",title:"Generated Result",loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    ")),(0,i.mdx)("h2",{id:"complete-sample-code"},"Complete sample code"),(0,i.mdx)("p",null,"If it's helpful to see a complete implementation, we've provide the full JavaScript code sample."),(0,i.mdx)(d,{mdxType:"Accordion"},(0,i.mdx)(m,{header:"Full code sample",isChevronIcon:!0,position:"right",iconColor:"#1473E6",mdxType:"AccordionItem"},(0,i.mdx)("pre",null,(0,i.mdx)("code",{parentName:"pre",className:"language-js"},'const axios = require("axios");\n\n// Ensure ACCESS_TOKEN environment variable is there with the correct value of access token\nconst { ACCESS_TOKEN } = process.env;\n\n// REST API\'s status codes\nconst STATUS_ACCEPTED = 202;\nconst DEFAULT_SERVICE_BASE_URL = "https://ff-services-api-stage.adobe.io";\n\n// object containing api endpoints\nconst apiEndpoints = {\n  FILL_MASKED_AREAS: "/v1/fill-masked-areas",\n};\n\n/**\n * Function to make get api call\n * @param {string} url - Api end point\n * @param {object} headers - headers to be passed\n * @returns {Promise} - Response of the API call\n */\nfunction makeGetCall(url, headers) {\n  return axios.get(url, { headers });\n}\n\n/**\n * Function to make post api call\n * @param {string} url - Api end point\n * @param {object} payload - Payload to be passed\n * @param {object} headers - Headers to be passed\n * @returns {Promise} - Response of the API call\n */\nfunction makePostCall(url, payload, headers) {\n  return axios.post(url, payload, { headers });\n}\n\n/**\n * Function to make service api calls\n *  - post api call to get the status url\n *  - get api call to get the result\n * @param {string} url - Api end point\n * @param {object} payload - Payload to be passed\n * @param {object} headers - Headers to be passed\n * @returns {Promise} - Object of image urls and its properties\n */\nasync function makeServiceApiCall(url, payload, headers) {\n  const postResponse = await makePostCall(url, payload, headers);\n  if (postResponse.status === STATUS_ACCEPTED) {\n    const statusUrl = postResponse.data.statusUrl;\n    const getResult = await makeGetCall(statusUrl, headers);\n    return getResult.data;\n  } else {\n    console.log("Error in serviceApiCall post operation ", postResponse);\n  }\n}\n\n/**\n * Function to fill masked areas of image based on the masks provided\n * @param {object} payload - payload with image and masks\n * @param {object} headers - headers to be passed\n * @returns {Promise} - result of the api response\n */\nasync function fillMaskedArea(headers, serviceBaseUrl, payload) {\n  const endpoint = new URL(\n    apiEndpoints.FILL_MASKED_AREAS,\n    serviceBaseUrl\n  ).toString();\n  return makeServiceApiCall(endpoint, payload, headers);\n}\n\n/**\n * Function to fetch token\n * @returns {Promise} - token string\n */\nasync function fetchAccessToken() {\n  return `Bearer ${ACCESS_TOKEN}`;\n}\n\n/**\n * Function to generate headers\n * @returns {Promise} - headers object\n */\nasync function generateHeaders() {\n  const token = await fetchAccessToken();\n  const headers = {\n    "Content-Type": "application/json",\n    // Update X-Api-Key with the actual api key\n    "X-Api-Key": "<your_api_key>",\n    Authorization: token,\n  };\n  return headers;\n}\n\nasync function main() {\n  // update serviceBaseUrl\n  const serviceBaseUrl = "<your_service_base_url>" || DEFAULT_SERVICE_BASE_URL;\n  // update sourceImageUrl with the source image url\n  const sourceImageUrl = "<your_source_image_url>";\n  // update maskUrlArray with the mask urls\n  const maskUrlArray = ["<your_mask_url>"];\n  const headers = await generateHeaders();\n\n  const payload = {\n    image: {\n      source: {\n        url: sourceImageUrl\n      }\n    },\n    masks: maskUrlArray.map((mask) => ({\n      source: {\n        url: mask\n      }\n    }))\n  };\n  const result = await fillMaskedArea(headers, serviceBaseUrl, payload);\n  const finalImage = result.image.destination.url;\n  return finalImage;\n}\n\nmain();\n')))))}h.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-guides-using-fill-mask-index-md-aab1885cb99e20c93ff2.js.map