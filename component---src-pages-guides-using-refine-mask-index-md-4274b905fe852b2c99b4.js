"use strict";(self.webpackChunkdev_site_documentation_template=self.webpackChunkdev_site_documentation_template||[]).push([[241],{3203:function(e,t,a){a.r(t),a.d(t,{_frontmatter:function(){return p},default:function(){return h}});var n=a(58168),o=a(80045),s=(a(88763),a(15680)),i=a(83407);const r=["components"],p={},m=e=>function(t){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),(0,s.mdx)("div",t)},c=m("InlineAlert"),l=m("Accordion"),d=m("AccordionItem"),f={_frontmatter:p},u=i.A;function h(e){let{components:t}=e,a=(0,o.A)(e,r);return(0,s.mdx)(u,(0,n.A)({},f,a,{components:t,mdxType:"MDXLayout"}),(0,s.mdx)("h1",{id:"enhance-image-mask-quality-with-refine-mask"},"Enhance image mask quality with Refine Mask"),(0,s.mdx)("p",null,"Learn how to use the Refine Masks API in your code workflows with this guide to enhance image mask quality."),(0,s.mdx)("h2",{id:"overview"},"Overview"),(0,s.mdx)("p",null,"In this tutorial, you'll learn how to use the Mask Refinement API to enhance the quality of your image masks. Whether you're working on image segmentation, graphic design, or any project that requires precise mask details, our API will help you achieve cleaner, smoother edges and more accurate mask representations."),(0,s.mdx)("p",null,"Follow along to see how easy it is to integrate this powerful tool into your workflow and elevate your image-processing tasks."),(0,s.mdx)("h2",{id:"about-the-refine-masks-api"},"About the Refine Masks API"),(0,s.mdx)("p",null,"Before getting into the code, let's consider how the Refine Masks API works at a high level."),(0,s.mdx)("ul",null,(0,s.mdx)("li",{parentName:"ul"},"You begin with a source image, uploaded to one of the supported cloud storage providers. See the API reference for the list of supported cloud storage providers."),(0,s.mdx)("li",{parentName:"ul"},"You then provide a ",(0,s.mdx)("em",{parentName:"li"},"masked")," version of the image. The Photoshop API will refine the mask according to the source image."),(0,s.mdx)("li",{parentName:"ul"},"You can provide a single mask for the input image that needs to be refined.")),(0,s.mdx)(c,{variant:"help",slots:"text",mdxType:"InlineAlert"}),(0,s.mdx)("p",null,"Use the ",(0,s.mdx)("a",{parentName:"p",href:"../../api/"},"v1/mask-objects")," endpoint first to generate masks to provide in your requests to this endpoint."),(0,s.mdx)("h2",{id:"prerequisites"},"Prerequisites"),(0,s.mdx)("ul",null,(0,s.mdx)("li",{parentName:"ul"},"Valid credentials. If you don't have them yet, first visit the Firefly Services ",(0,s.mdx)("a",{parentName:"li",href:"../index.md"},"Getting Started")," guide to obtain a ",(0,s.mdx)("inlineCode",{parentName:"li"},"client_id")," and ",(0,s.mdx)("inlineCode",{parentName:"li"},"client_secret"),"."),(0,s.mdx)("li",{parentName:"ul"},"Node.js installed on your machine and basic familiarity with ",(0,s.mdx)("inlineCode",{parentName:"li"},"JavaScript"),"."),(0,s.mdx)("li",{parentName:"ul"},"Store the source and mask images below in a supported cloud storage provider.")),(0,s.mdx)("h3",{id:"source-image"},"Source image"),(0,s.mdx)("p",null,(0,s.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1280px"}},"\n      ",(0,s.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"100%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,s.mdx)("picture",{parentName:"span"},"\n          ",(0,s.mdx)("source",{parentName:"picture",srcSet:["/ffs-photoshop-API/static/35602750574263073d9f74bc6392eb95/5530d/source-image-refinement.webp 320w","/ffs-photoshop-API/static/35602750574263073d9f74bc6392eb95/0c8fb/source-image-refinement.webp 640w","/ffs-photoshop-API/static/35602750574263073d9f74bc6392eb95/94b1e/source-image-refinement.webp 1280w","/ffs-photoshop-API/static/35602750574263073d9f74bc6392eb95/0b34d/source-image-refinement.webp 1920w","/ffs-photoshop-API/static/35602750574263073d9f74bc6392eb95/96d48/source-image-refinement.webp 2048w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/webp"}),"\n          ",(0,s.mdx)("source",{parentName:"picture",srcSet:["/ffs-photoshop-API/static/35602750574263073d9f74bc6392eb95/8980b/source-image-refinement.jpg 320w","/ffs-photoshop-API/static/35602750574263073d9f74bc6392eb95/56d4e/source-image-refinement.jpg 640w","/ffs-photoshop-API/static/35602750574263073d9f74bc6392eb95/62aaf/source-image-refinement.jpg 1280w","/ffs-photoshop-API/static/35602750574263073d9f74bc6392eb95/aaf92/source-image-refinement.jpg 1920w","/ffs-photoshop-API/static/35602750574263073d9f74bc6392eb95/09658/source-image-refinement.jpg 2048w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/jpeg"}),"\n          ",(0,s.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/ffs-photoshop-API/static/35602750574263073d9f74bc6392eb95/62aaf/source-image-refinement.jpg",alt:"Source image",title:"Source image",loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    ")),(0,s.mdx)("h3",{id:"mask-image"},"Mask image"),(0,s.mdx)("p",null,(0,s.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1280px"}},"\n      ",(0,s.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"100%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,s.mdx)("picture",{parentName:"span"},"\n          ",(0,s.mdx)("source",{parentName:"picture",srcSet:["/ffs-photoshop-API/static/0443679d046272c872511df2575002e4/5530d/mask-image-refinement.webp 320w","/ffs-photoshop-API/static/0443679d046272c872511df2575002e4/0c8fb/mask-image-refinement.webp 640w","/ffs-photoshop-API/static/0443679d046272c872511df2575002e4/94b1e/mask-image-refinement.webp 1280w","/ffs-photoshop-API/static/0443679d046272c872511df2575002e4/0b34d/mask-image-refinement.webp 1920w","/ffs-photoshop-API/static/0443679d046272c872511df2575002e4/96d48/mask-image-refinement.webp 2048w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/webp"}),"\n          ",(0,s.mdx)("source",{parentName:"picture",srcSet:["/ffs-photoshop-API/static/0443679d046272c872511df2575002e4/dd4a7/mask-image-refinement.png 320w","/ffs-photoshop-API/static/0443679d046272c872511df2575002e4/0f09e/mask-image-refinement.png 640w","/ffs-photoshop-API/static/0443679d046272c872511df2575002e4/bbbf7/mask-image-refinement.png 1280w","/ffs-photoshop-API/static/0443679d046272c872511df2575002e4/ac7a9/mask-image-refinement.png 1920w","/ffs-photoshop-API/static/0443679d046272c872511df2575002e4/2eb59/mask-image-refinement.png 2048w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/png"}),"\n          ",(0,s.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/ffs-photoshop-API/static/0443679d046272c872511df2575002e4/bbbf7/mask-image-refinement.png",alt:"Mask image",title:"Mask image",loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    ")),(0,s.mdx)("h2",{id:"using-color-decontamination"},"Using color decontamination"),(0,s.mdx)("p",null,"The ",(0,s.mdx)("inlineCode",{parentName:"p"},"colorDecontamination")," parameter determines whether color decontamination should be applied to the foreground of the input image. When set to ",(0,s.mdx)("inlineCode",{parentName:"p"},"true"),", the API will remove any color fringing and contamination from the foreground, ensuring a more accurate and clean RGBA mask output."),(0,s.mdx)("h2",{id:"calling-the-refine-masks-api"},"Calling the Refine Masks API"),(0,s.mdx)("p",null,"Here is a simple example of the request body required to use the Refine Masks API:"),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-json"},'{\n  "image": {\n    "source": {\n      "url": "<source_image_url>"\n    }\n  },\n  "mask": {\n    "source": {\n      "url": "<mask_image_url>"\n    }\n  },\n  "colorDecontamination": false\n}\n')),(0,s.mdx)("p",null,"The source of the images, take pre-signed URLs from the cloud storage provider."),(0,s.mdx)("h2",{id:"generated-result"},"Generated result"),(0,s.mdx)("p",null,"You can see in the image below that the mask has been refined."),(0,s.mdx)("p",null,(0,s.mdx)("strong",{parentName:"p"},"Result without color decontamination")),(0,s.mdx)("p",null,(0,s.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1280px"}},"\n      ",(0,s.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"100%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,s.mdx)("picture",{parentName:"span"},"\n          ",(0,s.mdx)("source",{parentName:"picture",srcSet:["/ffs-photoshop-API/static/5e53e3278ce042ab7e407c99a9b1903e/5530d/result-image-refinement.webp 320w","/ffs-photoshop-API/static/5e53e3278ce042ab7e407c99a9b1903e/0c8fb/result-image-refinement.webp 640w","/ffs-photoshop-API/static/5e53e3278ce042ab7e407c99a9b1903e/94b1e/result-image-refinement.webp 1280w","/ffs-photoshop-API/static/5e53e3278ce042ab7e407c99a9b1903e/0b34d/result-image-refinement.webp 1920w","/ffs-photoshop-API/static/5e53e3278ce042ab7e407c99a9b1903e/96d48/result-image-refinement.webp 2048w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/webp"}),"\n          ",(0,s.mdx)("source",{parentName:"picture",srcSet:["/ffs-photoshop-API/static/5e53e3278ce042ab7e407c99a9b1903e/dd4a7/result-image-refinement.png 320w","/ffs-photoshop-API/static/5e53e3278ce042ab7e407c99a9b1903e/0f09e/result-image-refinement.png 640w","/ffs-photoshop-API/static/5e53e3278ce042ab7e407c99a9b1903e/bbbf7/result-image-refinement.png 1280w","/ffs-photoshop-API/static/5e53e3278ce042ab7e407c99a9b1903e/ac7a9/result-image-refinement.png 1920w","/ffs-photoshop-API/static/5e53e3278ce042ab7e407c99a9b1903e/2eb59/result-image-refinement.png 2048w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/png"}),"\n          ",(0,s.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/ffs-photoshop-API/static/5e53e3278ce042ab7e407c99a9b1903e/bbbf7/result-image-refinement.png",alt:"Generated Result",title:"Generated Result",loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    ")),(0,s.mdx)("p",null,(0,s.mdx)("strong",{parentName:"p"},"Result with color decontamination")),(0,s.mdx)("p",null,(0,s.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1280px"}},"\n      ",(0,s.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"100%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,s.mdx)("picture",{parentName:"span"},"\n          ",(0,s.mdx)("source",{parentName:"picture",srcSet:["/ffs-photoshop-API/static/f12a3f39c8ab1b719c4b6e96a664f9c0/5530d/result-image1-color.webp 320w","/ffs-photoshop-API/static/f12a3f39c8ab1b719c4b6e96a664f9c0/0c8fb/result-image1-color.webp 640w","/ffs-photoshop-API/static/f12a3f39c8ab1b719c4b6e96a664f9c0/94b1e/result-image1-color.webp 1280w","/ffs-photoshop-API/static/f12a3f39c8ab1b719c4b6e96a664f9c0/0b34d/result-image1-color.webp 1920w","/ffs-photoshop-API/static/f12a3f39c8ab1b719c4b6e96a664f9c0/96d48/result-image1-color.webp 2048w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/webp"}),"\n          ",(0,s.mdx)("source",{parentName:"picture",srcSet:["/ffs-photoshop-API/static/f12a3f39c8ab1b719c4b6e96a664f9c0/dd4a7/result-image1-color.png 320w","/ffs-photoshop-API/static/f12a3f39c8ab1b719c4b6e96a664f9c0/0f09e/result-image1-color.png 640w","/ffs-photoshop-API/static/f12a3f39c8ab1b719c4b6e96a664f9c0/bbbf7/result-image1-color.png 1280w","/ffs-photoshop-API/static/f12a3f39c8ab1b719c4b6e96a664f9c0/ac7a9/result-image1-color.png 1920w","/ffs-photoshop-API/static/f12a3f39c8ab1b719c4b6e96a664f9c0/2eb59/result-image1-color.png 2048w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/png"}),"\n          ",(0,s.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/ffs-photoshop-API/static/f12a3f39c8ab1b719c4b6e96a664f9c0/bbbf7/result-image1-color.png",alt:"Color Decontaminated Result",title:"Color Decontaminated Result",loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    ")),(0,s.mdx)("h2",{id:"complete-sample-code"},"Complete sample code"),(0,s.mdx)("p",null,"If it's helpful to see a complete implementation, we've provide the full JavaScript code sample."),(0,s.mdx)(l,{mdxType:"Accordion"},(0,s.mdx)(d,{header:"Full code sample",isChevronIcon:!0,position:"right",iconColor:"#1473E6",mdxType:"AccordionItem"},(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-js"},'const axios = require("axios");\n \n// REST API\'s status codes\nconst STATUS_ACCEPTED = 202;\nconst DEFAULT_SERVICE_BASE_URL = "https://api-facade-service-stage.adobe.io";\n \n// object containing api endpoints\nconst apiEndpoints = {\n  REFINE_MASK: "/v1/refine-mask",\n};\n \n/**\n * Function to make get api call\n * @param {string} url - Api end point\n * @param {object} headers - headers to be passed\n * @returns {Promise} - Response of the API call\n */\nfunction makeGetCall(url, headers) {\n  return axios.get(url, { headers });\n}\n \n/**\n * Function to make post api call\n * @param {string} url - Api end point\n * @param {object} payload - Payload to be passed\n * @param {object} headers - Headers to be passed\n * @returns {Promise} - Response of the API call\n */\nfunction makePostCall(url, payload, headers) {\n  return axios.post(url, payload, { headers });\n}\n \n/**\n * Function to make service api calls\n *  - post api call to get the status url\n *  - get api call to get the result\n * @param {string} url - Api end point\n * @param {object} payload - Payload to be passed\n * @param {object} headers - Headers to be passed\n * @returns {Promise} - Object of image urls and its properties\n */\nasync function makeServiceApiCall(url, payload, headers) {\n  const postResponse = await makePostCall(url, payload, headers);\n  if (postResponse.status === STATUS_ACCEPTED) {\n    const statusUrl = postResponse.data.statusUrl;\n    const getResult = await makeGetCall(statusUrl, headers);\n    return getResult.data;\n  } else {\n    console.log("Error in serviceApiCall post operation ", postResponse);\n  }\n}\n \n/**\n * Function to refine mask of the image\n * @param {object} payload - payload with image and masks\n * @param {object} headers - headers to be passed\n * @returns {Promise} - object containing foreground object images\n */\nasync function refineMask(headers, serviceBaseUrl, payload) {\n  try {\n    const endpoint = new URL(\n      apiEndpoints.REFINE_MASK,\n      serviceBaseUrl\n    ).toString();\n    return makeServiceApiCall(endpoint, payload, headers);\n  } catch (error) {\n    console.log("Error inside refineMask function ", error);\n  }\n}\n \n/**\n * Function to fetch token\n * @returns {Promise} - token string\n */\nasync function fetchAccessToken() {\n  //TODO: Implement logic to fetch token\n  const token = "Bearer <your_access_token>";\n  return token;\n}\n \n/**\n * Function to generate headers\n * @returns {Promise} - headers object\n */\nasync function generateHeaders() {\n  // const apiKey = await fetchApiKey();\n  const token = await fetchAccessToken();\n  const headers = {\n    "Content-Type": "application/json",\n    // Update X-Api-Key with the actual api key\n    "X-Api-Key": "<your_api_key>",\n    Authorization: token,\n  };\n  return headers;\n}\n \nasync function main() {\n  // update serviceBaseUrl\n  const serviceBaseUrl = "<your_service_base_url>" || DEFAULT_SERVICE_BASE_URL;\n  // update sourceImageUrl with the source image url\n  const sourceImageUrl = "<your_source_image_url>";\n  // update maskUrl with the mask url\n  const maskUrl = "<your_mask_url>";\n  const headers = await generateHeaders();\n \n  const payload = {\n    image: {\n      source: {\n        url: sourceImageUrl\n      }\n    },\n    mask: {\n      source: {\n        url: maskUrl\n      }\n    },\n    colorDecontamination: false\n  };\n  const result = await refineMask(headers, serviceBaseUrl, payload);\n  return result;\n}\n \nmain();\n')))))}h.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-guides-using-refine-mask-index-md-4274b905fe852b2c99b4.js.map